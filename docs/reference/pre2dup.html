<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Drug Use Periods from Drug Purchase Data — pre2dup • PRE2DUPR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Drug Use Periods from Drug Purchase Data — pre2dup"><meta name="description" content="Estimates drug use periods based on individual drug purchase data. Optionally, hospitalization data can be incorporated. The estimation uses package-specific and Anatomical Therapeutic Chemical (ATC) Classification code -level parameters. This function supports estimation for individuals with varied purchase patterns, including stockpiling behavior."><meta property="og:description" content="Estimates drug use periods based on individual drug purchase data. Optionally, hospitalization data can be incorporated. The estimation uses package-specific and Anatomical Therapeutic Chemical (ATC) Classification code -level parameters. This function supports estimation for individuals with varied purchase patterns, including stockpiling behavior."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PRE2DUPR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../tutorials/Instruction_to_build_package_parameter.html">Package Parameters</a></li>
    <li><a class="dropdown-item" href="../tutorials/introduction_to_ATC_parameter.html">ATC Parameters</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Drug Use Periods from Drug Purchase Data</h1>

      <div class="d-none name"><code>pre2dup.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates drug use periods based on individual drug purchase data. Optionally, hospitalization data can be incorporated. The estimation uses package-specific and Anatomical Therapeutic Chemical (ATC) Classification code -level parameters. This function supports estimation for individuals with varied purchase patterns, including stockpiling behavior.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pre2dup</span><span class="op">(</span></span>
<span>  <span class="va">pre_data</span>,</span>
<span>  <span class="va">pre_person_id</span>,</span>
<span>  <span class="va">pre_atc</span>,</span>
<span>  <span class="va">pre_package_id</span>,</span>
<span>  <span class="va">pre_date</span>,</span>
<span>  <span class="va">pre_ratio</span>,</span>
<span>  <span class="va">pre_ddd</span>,</span>
<span>  <span class="va">package_parameters</span>,</span>
<span>  <span class="va">pack_atc</span>,</span>
<span>  <span class="va">pack_id</span>,</span>
<span>  <span class="va">pack_ddd_low</span>,</span>
<span>  <span class="va">pack_ddd_usual</span>,</span>
<span>  <span class="va">pack_dur_min</span>,</span>
<span>  <span class="va">pack_dur_usual</span>,</span>
<span>  <span class="va">pack_dur_max</span>,</span>
<span>  <span class="va">atc_parameters</span>,</span>
<span>  <span class="va">atc_class</span>,</span>
<span>  <span class="va">atc_ddd_low</span>,</span>
<span>  <span class="va">atc_ddd_usual</span>,</span>
<span>  <span class="va">atc_dur_min</span>,</span>
<span>  <span class="va">atc_dur_max</span>,</span>
<span>  hosp_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hosp_person_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hosp_admission <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hosp_discharge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  global_gap_max <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  global_min <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  global_max <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  global_max_single <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  global_ddd_high <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  global_hosp_max <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  days_covered <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  weight_past <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight_current <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  weight_next <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight_first_last <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  calculate_pack_dur_usual <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  post_process_perc <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pre-data">pre_data<a class="anchor" aria-label="anchor" href="#arg-pre-data"></a></dt>
<dd><p>data.frame or data.table containing drug purchases.</p></dd>


<dt id="arg-pre-person-id">pre_person_id<a class="anchor" aria-label="anchor" href="#arg-pre-person-id"></a></dt>
<dd><p>character, name of the column containing person id.</p></dd>


<dt id="arg-pre-atc">pre_atc<a class="anchor" aria-label="anchor" href="#arg-pre-atc"></a></dt>
<dd><p>character, name of the column containing ATC code.</p></dd>


<dt id="arg-pre-package-id">pre_package_id<a class="anchor" aria-label="anchor" href="#arg-pre-package-id"></a></dt>
<dd><p>character, name of the column containing package id.</p></dd>


<dt id="arg-pre-date">pre_date<a class="anchor" aria-label="anchor" href="#arg-pre-date"></a></dt>
<dd><p>character, name of the column containing purchase date.</p></dd>


<dt id="arg-pre-ratio">pre_ratio<a class="anchor" aria-label="anchor" href="#arg-pre-ratio"></a></dt>
<dd><p>character, name of the column containing ratio of packages purchased (e.g., number of packages).</p></dd>


<dt id="arg-pre-ddd">pre_ddd<a class="anchor" aria-label="anchor" href="#arg-pre-ddd"></a></dt>
<dd><p>character, name of the column containing defined daily doses (DDD) of the purchase.</p></dd>


<dt id="arg-package-parameters">package_parameters<a class="anchor" aria-label="anchor" href="#arg-package-parameters"></a></dt>
<dd><p>data.frame or data.table containing package parameters.</p></dd>


<dt id="arg-pack-atc">pack_atc<a class="anchor" aria-label="anchor" href="#arg-pack-atc"></a></dt>
<dd><p>character, name of the column containing ATC code.</p></dd>


<dt id="arg-pack-id">pack_id<a class="anchor" aria-label="anchor" href="#arg-pack-id"></a></dt>
<dd><p>character, name of the column containing package id.</p></dd>


<dt id="arg-pack-ddd-low">pack_ddd_low<a class="anchor" aria-label="anchor" href="#arg-pack-ddd-low"></a></dt>
<dd><p>character, name of the column containing lower limit of daily DDD.</p></dd>


<dt id="arg-pack-ddd-usual">pack_ddd_usual<a class="anchor" aria-label="anchor" href="#arg-pack-ddd-usual"></a></dt>
<dd><p>character, name of the column containing usual daily DDD.</p></dd>


<dt id="arg-pack-dur-min">pack_dur_min<a class="anchor" aria-label="anchor" href="#arg-pack-dur-min"></a></dt>
<dd><p>character, name of the column containing minimum duration of the package.</p></dd>


<dt id="arg-pack-dur-usual">pack_dur_usual<a class="anchor" aria-label="anchor" href="#arg-pack-dur-usual"></a></dt>
<dd><p>character, name of the column containing usual duration of the package.</p></dd>


<dt id="arg-pack-dur-max">pack_dur_max<a class="anchor" aria-label="anchor" href="#arg-pack-dur-max"></a></dt>
<dd><p>character, name of the column containing maximum duration of the package.</p></dd>


<dt id="arg-atc-parameters">atc_parameters<a class="anchor" aria-label="anchor" href="#arg-atc-parameters"></a></dt>
<dd><p>data.frame or data.table containing ATC parameters.</p></dd>


<dt id="arg-atc-class">atc_class<a class="anchor" aria-label="anchor" href="#arg-atc-class"></a></dt>
<dd><p>character, name of the column containing ATC class.</p></dd>


<dt id="arg-atc-ddd-low">atc_ddd_low<a class="anchor" aria-label="anchor" href="#arg-atc-ddd-low"></a></dt>
<dd><p>character, name of the column containing lower limit of daily DDD for the ATC class.</p></dd>


<dt id="arg-atc-ddd-usual">atc_ddd_usual<a class="anchor" aria-label="anchor" href="#arg-atc-ddd-usual"></a></dt>
<dd><p>character, name of the column containing usual daily DDD for the ATC class.</p></dd>


<dt id="arg-atc-dur-min">atc_dur_min<a class="anchor" aria-label="anchor" href="#arg-atc-dur-min"></a></dt>
<dd><p>character, name of the column containing minimum duration for the ATC class.</p></dd>


<dt id="arg-atc-dur-max">atc_dur_max<a class="anchor" aria-label="anchor" href="#arg-atc-dur-max"></a></dt>
<dd><p>character, name of the column containing maximum duration for the ATC class.</p></dd>


<dt id="arg-hosp-data">hosp_data<a class="anchor" aria-label="anchor" href="#arg-hosp-data"></a></dt>
<dd><p>data.frame or data.table containing hospitalizations.</p></dd>


<dt id="arg-hosp-person-id">hosp_person_id<a class="anchor" aria-label="anchor" href="#arg-hosp-person-id"></a></dt>
<dd><p>character, name of the column containing person id.</p></dd>


<dt id="arg-hosp-admission">hosp_admission<a class="anchor" aria-label="anchor" href="#arg-hosp-admission"></a></dt>
<dd><p>character, name of the column containing admission date.</p></dd>


<dt id="arg-hosp-discharge">hosp_discharge<a class="anchor" aria-label="anchor" href="#arg-hosp-discharge"></a></dt>
<dd><p>character, name of the column containing discharge date.</p></dd>


<dt id="arg-date-range">date_range<a class="anchor" aria-label="anchor" href="#arg-date-range"></a></dt>
<dd><p>character, vector of two dates, start and end of the purchase data.</p></dd>


<dt id="arg-global-gap-max">global_gap_max<a class="anchor" aria-label="anchor" href="#arg-global-gap-max"></a></dt>
<dd><p>numeric, maximum gap between purchases, default 300..</p></dd>


<dt id="arg-global-min">global_min<a class="anchor" aria-label="anchor" href="#arg-global-min"></a></dt>
<dd><p>numeric, minimum duration of a purchase, default 5.</p></dd>


<dt id="arg-global-max">global_max<a class="anchor" aria-label="anchor" href="#arg-global-max"></a></dt>
<dd><p>numeric, maximum duration of a purchase, default 300.</p></dd>


<dt id="arg-global-max-single">global_max_single<a class="anchor" aria-label="anchor" href="#arg-global-max-single"></a></dt>
<dd><p>numeric, maximum duration of a single purchase, default 150.</p></dd>


<dt id="arg-global-ddd-high">global_ddd_high<a class="anchor" aria-label="anchor" href="#arg-global-ddd-high"></a></dt>
<dd><p>numeric, maximum daily DDD for a purchase per day for any ATC, default 10.</p></dd>


<dt id="arg-global-hosp-max">global_hosp_max<a class="anchor" aria-label="anchor" href="#arg-global-hosp-max"></a></dt>
<dd><p>numeric, maximum number of hospital days to be considered when estimating the exposure duration, default 30.</p></dd>


<dt id="arg-days-covered">days_covered<a class="anchor" aria-label="anchor" href="#arg-days-covered"></a></dt>
<dd><p>numeric, maximum number of days to be added to the exposure duration to cover the gap between purchases, default 5.</p></dd>


<dt id="arg-weight-past">weight_past<a class="anchor" aria-label="anchor" href="#arg-weight-past"></a></dt>
<dd><p>numeric, weight for the past purchase in sliding average calculation, default 1.</p></dd>


<dt id="arg-weight-current">weight_current<a class="anchor" aria-label="anchor" href="#arg-weight-current"></a></dt>
<dd><p>numeric, weight for the current purchase in sliding average calculation, default 4.</p></dd>


<dt id="arg-weight-next">weight_next<a class="anchor" aria-label="anchor" href="#arg-weight-next"></a></dt>
<dd><p>numeric, weight for the next purchase in sliding average calculation, default 1.</p></dd>


<dt id="arg-weight-first-last">weight_first_last<a class="anchor" aria-label="anchor" href="#arg-weight-first-last"></a></dt>
<dd><p>numeric, weight for the first and last purchase in sliding average calculation, default 5.</p></dd>


<dt id="arg-calculate-pack-dur-usual">calculate_pack_dur_usual<a class="anchor" aria-label="anchor" href="#arg-calculate-pack-dur-usual"></a></dt>
<dd><p>TRUE or FALSE, re-calculate usual duration of the package based on the purchase frequency in data, default FALSE.</p></dd>


<dt id="arg-post-process-perc">post_process_perc<a class="anchor" aria-label="anchor" href="#arg-post-process-perc"></a></dt>
<dd><p>numeric, percentage of the data to be used in post-processing, default 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of two elements. Main element is <code>periods</code>: a data.table with one row per drug use period, including person, ATC, period start/end dates, duration, number of purchases, and total DDD. If <code>calculate_pack_dur_usual = TRUE</code>, an additional element <code>pack_info</code> contains updated package parameter information.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Before starting to estimate the drug use periods, the function validates the input data and arguments by checking for missing values and unacceptable duplicates.
It will stop execution if such issues are detected, with the following exceptions:</p>
<ul><li><p>Up to 10% of missing DDD values per ATC class in the drug purchase data is allowed.</p></li>
<li><p>Up to 10% of missing package parameter records per ATC class is allowed.</p></li>
</ul><p>If either threshold is exceeded, the function prompts the user to decide whether to continue.
If the user agrees, ATC classes with insufficient data are excluded, and the function proceeds with the remaining data.</p>
<p>There are five available methods for estimating the duration of each purchase, presented in the order of preference:</p><ul><li><p>Main method: Based on purchased daily doses (DDDs), temporal average of daily DDDs, and individual purchase patterns.</p></li>
<li><p>Package DDD method: Based on purchased DDDs and the usual daily DDD for the specific package.</p></li>
<li><p>Package duration method: Based on the usual duration of the package, considering the proportion of the package purchased.</p></li>
<li><p>ATC-level DDD method: Based on purchased DDDs and usual daily DDDs at the ATC level.</p></li>
<li><p>Minimum ATC duration method: Based on the minimum duration defined for the ATC group.</p></li>
</ul><p>Periods that are close in time can be joined in a post-processing step controlled by <code>post_process_perc</code>. Post processing percentage reduces by 0.1 at each estimation round to prevent very long calculation times for large datasets.</p>
<p>In addition to estimating drug use periods, the function can also calculate common package durations from the purchase data.
These calculated durations can be used to verify and adjust the usual duration parameters of packages.
After making corrections, re-run the function to recalculate drug use periods using the updated package parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Each data type has their own check functions. <code>pre2dup</code> runs the checks internally, but checking the validity before running the program is recommended for faster and easier error detection and handling.</p>
<p><code><a href="check_purchases.html">check_purchases</a></code>, <code><a href="check_hospitalizations.html">check_hospitalizations</a></code>, <code><a href="check_package_parameters.html">check_package_parameters</a></code>, <code><a href="check_atc_parameters.html">check_atc_parameters</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">period_data</span> <span class="op">&lt;-</span><span class="fu">pre2dup</span><span class="op">(</span>pre_data <span class="op">=</span> <span class="va">purchases_example</span>, pre_person_id <span class="op">=</span> <span class="st">"id"</span>,</span></span>
<span class="r-in"><span> pre_atc <span class="op">=</span> <span class="st">"ATC"</span>, pre_package_id <span class="op">=</span> <span class="st">"vnr"</span>, pre_date <span class="op">=</span> <span class="st">"purchase_date"</span>,</span></span>
<span class="r-in"><span>  pre_ratio <span class="op">=</span> <span class="st">"n_packages"</span>, pre_ddd <span class="op">=</span> <span class="st">"amount"</span>,</span></span>
<span class="r-in"><span>   package_parameters <span class="op">=</span> <span class="va">package_parameters_example</span>,</span></span>
<span class="r-in"><span>    pack_atc <span class="op">=</span> <span class="st">"ATC"</span>, pack_id <span class="op">=</span> <span class="st">"vnr"</span>, pack_ddd_low <span class="op">=</span> <span class="st">"lower_ddd"</span>,</span></span>
<span class="r-in"><span>     pack_ddd_usual <span class="op">=</span><span class="st">"usual_ddd"</span>, pack_dur_min <span class="op">=</span> <span class="st">"minimum_dur"</span>,</span></span>
<span class="r-in"><span>      pack_dur_usual <span class="op">=</span> <span class="st">"usual_dur"</span>, pack_dur_max <span class="op">=</span> <span class="st">"maximum_dur"</span>,</span></span>
<span class="r-in"><span>       atc_parameters <span class="op">=</span> <span class="va">ATC_parameters</span>, atc_class <span class="op">=</span> <span class="st">"partial_atc"</span>,</span></span>
<span class="r-in"><span>       atc_ddd_low <span class="op">=</span> <span class="st">"lower_ddd_atc"</span>, atc_ddd_usual <span class="op">=</span> <span class="st">"usual_ddd_atc"</span>,</span></span>
<span class="r-in"><span>        atc_dur_min <span class="op">=</span> <span class="st">"minimum_dur_atc"</span>, atc_dur_max <span class="op">=</span> <span class="st">"maximum_dur_atc"</span>,</span></span>
<span class="r-in"><span>         hosp_data <span class="op">=</span> <span class="va">hospitalizations_example</span>, hosp_person_id <span class="op">=</span> <span class="st">"id"</span>,</span></span>
<span class="r-in"><span>          hosp_admission <span class="op">=</span> <span class="st">"hospital_start"</span>, hosp_discharge <span class="op">=</span> <span class="st">"hospital_end"</span>,</span></span>
<span class="r-in"><span>           date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2025-01-01"</span>, <span class="st">"2025-12-31"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            global_gap_max <span class="op">=</span> <span class="fl">300</span>, global_min <span class="op">=</span> <span class="fl">5</span>, global_max <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>             global_max_single <span class="op">=</span> <span class="fl">150</span>, global_ddd_high <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>              global_hosp_max <span class="op">=</span> <span class="fl">30</span>, weight_past <span class="op">=</span> <span class="fl">1</span>, weight_current <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>               weight_next <span class="op">=</span> <span class="fl">1</span>, weight_first_last <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                calculate_pack_dur_usual <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 days_covered <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                 post_process_perc <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 1/6: Checking parameters and datasets...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checks passed for 'pre_data'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checks passed for 'package_parameters'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checks passed for 'atc_parameters'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checks passed for 'hosp_data'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 2/6: Calculating purchase durations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 3/6: Stockpiling assessment...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 4/6: Calculating common package durations in data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Refill lengths couldn't be re-estimated, probably due to too small data size.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 5/6: Preparing drug use periods...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Step 6/6: Post-processing drug use periods...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Current post processing percentage: 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Drug use periods calculated. 7 periods created for 5 persons.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">period_data</span><span class="op">$</span><span class="va">periods</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    period     id     ATC  dup_start    dup_end dup_days dup_hospital_days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt; &lt;fctr&gt;  &lt;char&gt;     &lt;Date&gt;     &lt;Date&gt;    &lt;num&gt;             &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      1      1 N05AH02 2025-01-01 2025-04-14      104                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:      2      2 N05AH02 2025-01-15 2025-04-28      104                 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:      3      3 N05AH02 2025-02-01 2025-05-15      104                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:      4      3 N05AH04 2025-01-05 2025-08-26      233                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:      5      4 N05AH02 2025-01-10 2025-04-23      104                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:      6      4 N05AH04 2025-01-20 2025-09-10      233                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:      7      5 N05AH04 2025-01-01 2025-08-22      233                38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    dup_n_purchases dup_last_purchase dup_total_DDD dup_temporal_average_DDDs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;int&gt;            &lt;Date&gt;         &lt;num&gt;                     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:               3        2025-03-08         99.99                     0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:               3        2025-03-22         99.99                     0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:               3        2025-04-08         99.99                     0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:               2        2025-04-15        200.00                     0.858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:               3        2025-03-17         99.99                     0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:               2        2025-04-30        200.00                     0.858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:               2        2025-04-11        200.00                     0.858</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pia Vattulainen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

